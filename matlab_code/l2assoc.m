%% 401.bzip2 benchmark

%icache size 
%icache assoc
%dcache size

%dcache assoc
pds4 =1.098 + 0.00726281 + 0.292322 +0.0046776  + 0.000568258 +0.0142344 ;
ds4 = 0.083788;
peak4 =1.95501 + 0.539259 ; 
pds16 = 1.098+0.00726281  +0.292076  +0.00494005  +0.000605182  +0.0143381;
ds16=0.083858;
peak16 = 1.95501 + 0.540844;
pds32 =1.098 + 0.00726281 + 0.292061 +0.00527753  + 0.000654024 +0.0147017;
ds32=0.083862;
peak32 = 1.95501 + 0.545314;

edpb4 = pds4 * ds4;
edpb16= pds16 * ds16;
edpb32= pds32 * ds32;
%l2 size

%l2 assoc

%cacheline

%% 429.mcf benchmark
mf4 =1.098 + 0.00726281 + 0.33721 +0.0046776  +0.000568258  +0.00142156; 
md4=0.055470;
mf4peak=1.95501 + 0.539259;
mf16=1.098 +0.00726281  + 0.337201 +0.00494005  +0.000605182  +0.00144133;
mf16peak=1.95501 + 0.540844; 
md16 =0.055472;
mf32 = 1.098 + 0.00726281 +0.33721  +0.00527753  +0.000654024  +0.00148549;
mf32peak = 1.95501 + 0.545314;
md32 = 0.055470;

edpm4 = mf4 * md4 ;
edpm16 = mf16 * md16 ;
edpm32 = mf32 * md32 ;

%% 456.hmmer benchmark
hm4 =1.098 +0.00726281  +0.359916  +0.0046776  +0.000568258  +0.00236486;
hm4peak =1.95501 +  0.539259;
hd4 =0.059410;
hm16 =1.098 + 0.00726281 + 0.359916 +0.00494005  +0.000605182  +0.00239015;
hm16peak = 1.95501 + 0.540844;
hd16= 0.059410; 
hm32= 1.098 + 0.00726281 +0.359916  + 0.00527753 + 0.000654024 +0.00244677;
hm32peak= 1.95501 +0.545314 ;
hd32 = 0.059410 ;

edph4 = hm4 * hd4;
edph16 =hm16 * hd16;
edph32 = hm32 * hd32;

%% 458.sjeng
jn4 =1.098 +0.00726281  + 0.0933748 +0.0046776  +0.000568258  +0.0144548;
jpeak4 =1.95501 + 0.539259;
jd4 = 0.513815;
jn16 =1.098 +0.00726281  +0.093371  +0.00494005  +0.000605182  +0.014683;
jpeak16 = 1.95501 +0.540844; 
jd16=0.513836;
jn32 =1.098 +0.00726281  +0.0933967  +0.00527753  +0.000654024  +0.0151958;
jpeak32= 1.95501 + 0.545314;
jd32 =0.513695; 

edpj4 = jn4 * jd4;
edpj16 = jn16 * jd16;
edpj32 = jn32 * jd32;

%% 470.lbm benchmark
l4= 1.098+ 0.00726281 +0.144718  +0.0046776  +0.000568258  +0.0120055;
l4peak =1.95501 +  0.539259;
ld4 = 0.174779;
l16 =1.098 +  0.00726281+ 0.144718 +0.00494005  +0.000605182  +0.0121955;
l16peak=1.95501 + 0.540844;
ld16 = 0.174779;
l32=1.098 +0.00726281  +0.144718  +0.00527753  +0.000654024  +0.012618;
l32peak=1.95501 + 0.545314;
ld32 =0.174779;

edpl4 = l4 * ld4;
edpl16= l16 * ld16;
edpl32 = l32 * ld32;
%% 
edp4 = (edpb4 + edpm4 + edph4 + edpj4 + edpl4)/5 ;
edp16 = (edpb16 + edpm16 + edph16 + edpj16 + edpl16)/5 ;
edp32 = (edpb32 + edpm32 + edph32 + edpj32 + edpl32)/5 ;
power = [edp4 edp16 edp32];
assoc = [4 16 32];




totPeak4 = (peak4 + mf4peak + hm4peak +jpeak4 + l4peak)/5;
totPeak16 = (peak16 + mf16peak + hm16peak+ jpeak16 + l16peak)/5;
totPeak32 =  (peak32 + mf32peak + hm32peak+ jpeak32 + l32peak)/5;
total = [totPeak4, totPeak16, totPeak32];
%% PLOTS 
plot(assoc, total, 'col','#D95319','Linewidth', 2);
title('L2 Associativity - Peak Power')
xlabel('Associativity')
ylabel('Peak Power(W)')